#!/bin/sh

REPO=https://github.com/bbatsov/prelude.git
FAKE_HOME="${HOME:?}"/.emacs-prelude.d
PRELUDE_DIR="${FAKE_HOME:?}"/.emacs.d
USER_CFG_DIR="${PRELUDE_DIR:?}"/personal

{
    test -e "${PRELUDE_DIR:?}" \
        || git clone --quiet "${REPO:?}" "${PRELUDE_DIR:?}"
} && {
    cat > "${USER_CFG_DIR:?}"/prelude-modules.el <<"EOF"
EOF
} && {
    env HOME="${FAKE_HOME:?}" emacs "$@"
}

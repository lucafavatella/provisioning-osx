#!/bin/sh

ROOT_DIR="${1:?}" ## Mandatory.

has_pb() {
    "${ROOT_DIR:?}"/bin/brew_pourable_bottle has "${1:?}"
}

had_pb() {
    "${ROOT_DIR:?}"/bin/brew_pourable_bottle had "${1:?}"
}

has_hv() {
    "${ROOT_DIR:?}"/bin/macos_has_hypervisor
}

#brew cask install iterm2 || exit 1 ## Mainly for configuring only left Option as Meta key, so to keep ability to insert `#` on UK keyboard (without losing `£`) while simplifying shell shortcuts (e.g. Alt+D).  Also for: implicitly copying text select with pointer; making clickable links in text by pressing a key. ## No Sixel support (VT340) - [ref](https://gitlab.com/gnachman/iterm2/issues/3240).
{ has_pb tmux; } || exit 1 # && brew install tmux; } || exit 1
brew install bash-completion || exit 1
{ brew install emacs && "${ROOT_DIR:?}"/bin/brew_emacs_upgrade; } || exit 1

brew cask install homebrew/cask-versions/firefox-developer-edition || exit 1

#brew cask install spectacle || exit 1

brew cask install docker || exit 1 ## Apparently the Docker daemon cannot be started from CLI hence [Docker.app needs to be run manually](https://docs.docker.com/docker-for-mac/install/#install-and-run-docker-for-mac). It needs privileged access [to install networking components and links to the Docker apps](https://docs.docker.com/docker-for-mac/install/#install-and-run-docker-for-mac).
has_hv; case "$?" in
            1) { brew install docker-machine || exit 1; } ;;
            0) ;;
            *) exit 1 ;;
        esac

#brew cask install android-platform-tools || exit 1 ## adb
#brew install android-sdk || exit 1 ## For IntelliJ.
#brew cask install android-studio || exit 1 ## From [IntelliJ IDEA and Android Studio FAQ](http://blog.jetbrains.com/idea/2013/05/intellij-idea-and-android-studio-faq/): "If I’m already a user of IntelliJ IDEA, do I need to switch to Android Studio for Android development? No. Android Studio is focused specifically on Android development and provides streamlined environment and project setup, but otherwise all of its features are available in IntelliJ IDEA."
brew install autoconf || exit 1
#brew install checkbashisms || exit 1
#brew cask install intellij-idea-ce || exit 1
{ has_pb jq; } || exit 1 # && brew install jq; } || exit 1
#brew install saitoha/sixel/mlterm || exit 1 ## Refs https://en.wikipedia.org/wiki/VT340 https://en.wikipedia.org/wiki/Sixel
brew install p7zip || exit 1 ## `7z x` works as a compression-agnostic archive extractor command better than BSD `tar -x` e.g. for `gzip` compression.
#brew install plantuml || exit 1
#brew install pstree || exit 1
#brew install pup || exit 1
{ brew install python && "${ROOT_DIR:?}"/bin/brew_python3_upgrade; } || exit 1
#brew install shellcheck || exit 1
{ has_pb sqlite; } || exit 1 # && brew install sqlite; } || exit 1
#brew install valgrind || exit 1
#brew install watch || exit 1

#brew cask install libreoffice || exit 1
#brew cask install vlc || exit 1

#!/bin/sh

set -e

ROOT_DIR="${1:?}" ## Mandatory.

DOTFILES_REPO=https://github.com/lucafavatella/dotfiles.git
DOTFILES_DIR="${ROOT_DIR:?}/home/dotfiles"
DOTFILES_ORIGIN="provisioning-osx"
DOTFILES_VERSION="${DOTFILES_ORIGIN:?}/master"
MANAGED_DOTFILES=".bash_profile .gitconfig .emacs"

## Dotfiles e.g. ~/.*

mkdir -p "${DOTFILES_DIR:?}" \
    && env REPO="${DOTFILES_REPO:?}" VERSION="${DOTFILES_VERSION:?}" DIR="${DOTFILES_DIR:?}" ORIGIN="${DOTFILES_ORIGIN:?}" "${ROOT_DIR:?}"/bin/git-get

for F in ${MANAGED_DOTFILES:?}; do
    "${ROOT_DIR:?}"/bin/lns "${DOTFILES_DIR:?}/${F:?}" "${HOME:?}/${F:?}"
done
